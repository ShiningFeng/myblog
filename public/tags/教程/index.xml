<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>教程 on ShiningFeng&#39;s Blog</title>
    <link>http://localhost:1313/tags/%E6%95%99%E7%A8%8B/</link>
    <description>Recent content in 教程 on ShiningFeng&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Fri, 06 Jun 2025 23:00:00 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/%E6%95%99%E7%A8%8B/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>从零实现网站自动签到 &#43; 鸿蒙 PUSH 推送 </title>
      <link>http://localhost:1313/posts/sign-push/</link>
      <pubDate>Fri, 06 Jun 2025 23:00:00 +0800</pubDate>
      
      <guid>http://localhost:1313/posts/sign-push/</guid>
      <description>完整实现网站自动签到流程，并通过鸿蒙 MeoW 实现每日签到结果推送。涵盖 Cookie 抓取、sign 参数解析、状态识别与推送机制。</description>
      <content:encoded><![CDATA[<p>本文记录了我如何使用 Python 脚本，自动完成网站的每日签到操作，并将签到结果通过鸿蒙系统的 MeoW 应用推送至手机，真正实现“自动签到 + 即时提醒”的全自动流程。</p>
<hr>
<h2 id="1-项目目标">1. 项目目标</h2>
<ul>
<li>每天自动访问 网站签到页面</li>
<li>自动提取网页动态参数 <code>sign</code></li>
<li>发送模拟点击请求进行签到</li>
<li>解析签到响应判断状态（成功、已签到、Cookie 失效等）</li>
<li>使用鸿蒙 MeoW 提供的接口推送签到结果</li>
<li>支持通过系统计划任务定时执行脚本</li>
</ul>
<hr>
<h2 id="2-环境准备">2. 环境准备</h2>
<h3 id="21-安装依赖库">2.1 安装依赖库</h3>
<p>我们使用 <code>requests</code> 进行网页请求，<code>BeautifulSoup</code> 进行 HTML 解析，命令如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pip install requests beautifulsoup4
</span></span></code></pre></div><hr>
<h3 id="22-获取登录-cookie">2.2 获取登录 Cookie</h3>
<p>访问网站并抓取 Cookie 值：</p>
<ol>
<li>打开浏览器登录网站，并勾选 “记住我”</li>
<li>按下 <code>F12</code> → 进入开发者工具 → 切换到「Application」面板</li>
<li>展开 Cookies → 找到域名 <code>https://www.网站.com</code></li>
<li>提取以下两个字段：</li>
</ol>
<pre tabindex="0"><code>bbs_sid=xxxx; bbs_token=xxxx
</code></pre><p>⚠️ 必须在登录状态下获取，否则 Cookie 会很快过期。</p>
<hr>
<h2 id="3--获取鸿蒙-push-接口">3.  获取鸿蒙 PUSH 接口</h2>
<p>升级鸿蒙NEXT系统的手机，去应用市场安装 <strong>MeoW App</strong> 后可获得你的推送链接，格式如下：</p>
<pre tabindex="0"><code>https://api.chuckfang.com/你的用户名/推送内容
</code></pre><p>将推送内容拼接至接口末尾即可实现消息推送。</p>
<hr>
<h2 id="4-签到流程逻辑详解">4. 签到流程逻辑详解</h2>
<ol>
<li>
<p>访问签到页 <code>https://www.网站.com/sg_sign.htm</code></p>
</li>
<li>
<p>从 JS 中提取动态参数 <code>sign</code></p>
</li>
<li>
<p>构造 POST 请求，附带 <code>sign</code> 参数发起签到</p>
</li>
<li>
<p>判断响应文本内容：</p>
<ul>
<li>✅ 签到成功</li>
<li>⚠️ 已签到</li>
<li>❌ Cookie 失效</li>
</ul>
</li>
<li>
<p>发送推送通知至鸿蒙手机</p>
</li>
</ol>
<hr>
<h2 id="5-完整代码">5. 完整代码</h2>
<p>保存为 <code>daily_auto_sign.py</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">datetime</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># === 配置区域 ===</span>
</span></span><span class="line"><span class="cl"><span class="n">COOKIE</span> <span class="o">=</span> <span class="s2">&#34;bbs_sid=xxxx; bbs_token=xxxx&#34;</span>  <span class="c1"># 替换为你的 Cookie</span>
</span></span><span class="line"><span class="cl"><span class="n">PUSH_API</span> <span class="o">=</span> <span class="s2">&#34;https://api.chuckfang.com/你的用户名&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Referer&#34;</span><span class="p">:</span> <span class="s2">&#34;https://www.网站.com/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Cookie&#34;</span><span class="p">:</span> <span class="n">COOKIE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send_push</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;推送消息到鸿蒙 MeoW&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="n">PUSH_API</span> <span class="o">+</span> <span class="n">content</span>
</span></span><span class="line"><span class="cl">        <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;❌ 推送失败：&#34;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_sign_token</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;提取签到参数 sign&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;https://www.网站.com/sg_sign.htm&#34;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&#34;html.parser&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">script</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&#34;script&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;sign\s*=\s*&#34;([^&#34;]+)&#34;&#39;</span><span class="p">,</span> <span class="n">script</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="k">match</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">sign_token</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;发送签到 POST 请求&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;sign&#34;</span><span class="p">:</span> <span class="n">sign_token</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;https://www.网站.com/sg_sign.htm&#34;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sign_in</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">sign_token</span> <span class="o">=</span> <span class="n">get_sign_token</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">sign_token</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2">] ❌ 获取 sign 参数失败&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">send_push</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">sign_token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;签到成功&#34;</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">or</span> <span class="s2">&#34;恭喜获得&#34;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2">] ✅ 签到成功&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="s2">&#34;已经签到&#34;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2">] ⚠️ 今天已签到&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="s2">&#34;请先登录&#34;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2">] ❌ Cookie 已失效&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;[</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2">] ❓ 未知返回&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">send_push</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">sign_in</span><span class="p">()</span>
</span></span></code></pre></div><hr>
<h2 id="6-设置定时任务windows">6. 设置定时任务（Windows）</h2>
<ol>
<li>创建 <code>run_sign.bat</code> 文件：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bat" data-lang="bat"><span class="line"><span class="cl"><span class="k">PATH</span>\TO\YOUR\python.exe D:\你的路径\daily_auto_sign.py
</span></span></code></pre></div><ol start="2">
<li>打开「任务计划程序」：
<ul>
<li>创建基本任务</li>
<li>触发器：每天 → 设置时间如早上 08:00</li>
<li>操作：启动程序 → 「程序或脚本」中直接输入：cmd.exe → 「添加参数（可选）」中输入：<code>/c start &quot;&quot; &quot;\YOUR\PATH\run_sign.bat&quot;</code></li>
</ul>
</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Word VBA 批处理：高效分离中英文翻译段落</title>
      <link>http://localhost:1313/posts/vba-chinese-english-split/</link>
      <pubDate>Thu, 17 Apr 2025 15:50:42 +0800</pubDate>
      
      <guid>http://localhost:1313/posts/vba-chinese-english-split/</guid>
      <description>本文将介绍如何利用 Word VBA 批处理，将中英文交替排列的文档中的段落自动提取分离。</description>
      <content:encoded><![CDATA[<p>在翻译或双语教学材料的处理中，我们经常会遇到 <strong>中英文交替排列的文档</strong>，每段中文后紧跟一段对应英文。手动分离这些翻译段不仅效率低，还容易出错。本文将介绍一种 <strong>使用 Word VBA 实现中英文段落自动分离</strong> 的完整解决方案。</p>
<h2 id="1-任务目标">1. 任务目标</h2>
<p>任务的核心目标是 <strong>分离Word文档中的中文和英文翻译</strong>。文档中每一段包含一个翻译对，中文翻译和英文翻译交替出现。我们需要将文档中的所有中文翻译和英文翻译分别提取并整理到新文档中，实现：</p>
<ul>
<li><strong>连续的中文段落</strong></li>
<li><strong>连续的英文段落</strong></li>
</ul>
<hr>
<h2 id="2-文档特点与处理难点">2. 文档特点与处理难点</h2>
<table>
  <thead>
      <tr>
          <th>问题</th>
          <th>描述</th>
          <th>解决方案</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>中英文交替段落</td>
          <td>文档结构为「中文段 → 英文段 → 中文段 → 英文段」</td>
          <td>使用正则和 Unicode 判断每段是中文还是英文</td>
      </tr>
      <tr>
          <td>软回车符（Line Break）</td>
          <td>表示段内换行，显示为 ↵，VBA 中为 <code>Chr(11)</code></td>
          <td>统一替换为真正的段落符 <code>vbCrLf</code></td>
      </tr>
      <tr>
          <td>制表符（Tab）</td>
          <td>显示为黑色方块，干扰排版</td>
          <td>替换为空字符串进行删除</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="3-问题与解决方案">3. 问题与解决方案</h2>
<h3 id="问题-1中文和英文翻译的分离">问题 1：中文和英文翻译的分离</h3>
<ul>
<li><strong>问题描述</strong>：中文和英文翻译在文档中是交替的，但它们并没有明确的分隔标志，且每个段落都是一个翻译单元。需要遍历每个段落并根据其内容判断该段落是中文还是英文，然后将它们分离到不同的部分。</li>
<li><strong>解决方案</strong>：
<ul>
<li>使用 <code>ContainsChinese</code> 函数来判断每个段落是否包含中文字符，通过遍历文档中的每个段落并根据语言类型分别存储中文和英文内容。</li>
<li>在分离文本时，我们确保每段中文或英文之间没有多余的空行，通过逻辑判断避免在每个段落后添加额外的换行符。</li>
</ul>
</li>
</ul>
<h3 id="问题-2软回车符的处理">问题 2：软回车符的处理</h3>
<ul>
<li><strong>问题描述</strong>：文档中的软回车符（Line Break，通常显示为向下箭头符号）并不是一个有效的回车字符，而只是行间的分隔符。它们需要被替换为硬回车符（换行符），否则文档格式可能会混乱。</li>
<li><strong>解决方案</strong>：
<ul>
<li>最初没有处理软回车符，导致文档中出现格式不一致的问题。通过查找并替换 <code>Chr(11)</code>（软回车符）为 <code>vbCrLf</code>（硬回车符），我们确保段落正确分隔，每个翻译对显示在新的行中。</li>
<li>通过 <code>.Text = Chr(11)</code> 查找软回车符并使用 <code>.Replacement.Text = vbCrLf</code> 进行替换，确保段落的格式整洁。</li>
</ul>
</li>
</ul>
<h3 id="问题-3制表符的处理">问题 3：制表符的处理</h3>
<ul>
<li><strong>问题描述</strong>：文档中包含制表符（Tab符号），这些符号显示为黑色方块，影响文档的整洁性。制表符通常用于缩进，但它们不适合在最终文档中出现。</li>
<li><strong>解决方案</strong>：
<ul>
<li>起初，没有处理制表符，导致文档中出现了难以去除的黑色方块。后来，我们通过查找并删除制表符（<code>Chr(9)</code>）来解决这个问题。为了不让其影响文档的视觉效果，我们将制表符替换为空字符串，从而删除它们。</li>
</ul>
</li>
</ul>
<h2 id="4-最终实现">4. 最终实现</h2>
<h3 id="第一步统一格式软回车与制表符清理">第一步：统一格式（软回车与制表符清理）</h3>
<ul>
<li>将所有软回车 <code>Chr(11)</code> 替换为真正的段落符 <code>vbCrLf</code></li>
<li>删除所有制表符 <code>Chr(9)</code></li>
</ul>
<h3 id="第二步判断每段语言类型">第二步：判断每段语言类型</h3>
<ul>
<li>遍历所有段落</li>
<li>利用 <code>AscW()</code> 判断字符是否在中文 Unicode 范围（19968~40959）</li>
</ul>
<h3 id="第三步将中英文段落分类收集">第三步：将中英文段落分类收集</h3>
<ul>
<li>若段落中包含中文字符，则归为中文段落</li>
<li>否则归为英文段落</li>
</ul>
<h3 id="第四步输出新文档">第四步：输出新文档</h3>
<ul>
<li>生成新 Word 文档</li>
<li>插入整理后的中文与英文内容</li>
<li>保存输出</li>
</ul>
<hr>
<h2 id="5-vba-源代码">5. VBA 源代码</h2>
<p>以下代码可直接复制到 Word 的 VBA 编辑器中使用：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vb" data-lang="vb"><span class="line"><span class="cl"><span class="k">Sub</span> <span class="nf">CleanUpAndSeparateText</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">Dim</span> <span class="n">doc</span> <span class="ow">As</span> <span class="n">Document</span>
</span></span><span class="line"><span class="cl">    <span class="k">Set</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">ActiveDocument</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">Dim</span> <span class="n">chineseText</span> <span class="ow">As</span> <span class="kt">String</span>
</span></span><span class="line"><span class="cl">    <span class="k">Dim</span> <span class="n">englishText</span> <span class="ow">As</span> <span class="kt">String</span>
</span></span><span class="line"><span class="cl">    <span class="k">Dim</span> <span class="n">para</span> <span class="ow">As</span> <span class="n">Paragraph</span>
</span></span><span class="line"><span class="cl">    <span class="k">Dim</span> <span class="n">paraText</span> <span class="ow">As</span> <span class="kt">String</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 初始化变量
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="n">chineseText</span> <span class="o">=</span> <span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">englishText</span> <span class="o">=</span> <span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 查找并替换软回车（向下箭头）为硬回车
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="k">With</span> <span class="n">doc</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">Find</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">ClearFormatting</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">Chr</span><span class="p">(</span><span class="n">11</span><span class="p">)</span> <span class="c">&#39; 软回车（Line Break）的ASCII码是 11
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">ClearFormatting</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">vbCrLf</span> <span class="c">&#39; 替换为真正的回车符
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="p">.</span><span class="n">Execute</span> <span class="n">Replace</span><span class="p">:</span><span class="o">=</span><span class="n">wdReplaceAll</span>
</span></span><span class="line"><span class="cl">    <span class="k">End</span> <span class="k">With</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 查找并删除制表符（Tab符号）
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="k">With</span> <span class="n">doc</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">Find</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">ClearFormatting</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">Chr</span><span class="p">(</span><span class="n">9</span><span class="p">)</span> <span class="c">&#39; 制表符的ASCII码是 9
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">ClearFormatting</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">Replacement</span><span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s">&#34;&#34;</span> <span class="c">&#39; 用空字符串替换（删除制表符）
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="p">.</span><span class="n">Execute</span> <span class="n">Replace</span><span class="p">:</span><span class="o">=</span><span class="n">wdReplaceAll</span>
</span></span><span class="line"><span class="cl">    <span class="k">End</span> <span class="k">With</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 遍历文档中的段落并进行中文和英文的分离
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="k">For</span> <span class="k">Each</span> <span class="n">para</span> <span class="ow">In</span> <span class="n">doc</span><span class="p">.</span><span class="n">Paragraphs</span>
</span></span><span class="line"><span class="cl">        <span class="n">paraText</span> <span class="o">=</span> <span class="n">Trim</span><span class="p">(</span><span class="n">para</span><span class="p">.</span><span class="n">Range</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span> <span class="c">&#39; 获取段落的文本
</span></span></span><span class="line"><span class="cl"><span class="c"></span>
</span></span><span class="line"><span class="cl">        <span class="c">&#39; 判断段落是否包含内容
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="k">If</span> <span class="n">Len</span><span class="p">(</span><span class="n">paraText</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="k">Then</span>
</span></span><span class="line"><span class="cl">            <span class="c">&#39; 判断段落是中文还是英文
</span></span></span><span class="line"><span class="cl"><span class="c"></span>            <span class="k">If</span> <span class="n">ContainsChinese</span><span class="p">(</span><span class="n">paraText</span><span class="p">)</span> <span class="k">Then</span>
</span></span><span class="line"><span class="cl">                <span class="c">&#39; 删除每个中文段落末尾的多余换行
</span></span></span><span class="line"><span class="cl"><span class="c"></span>                <span class="k">If</span> <span class="n">Len</span><span class="p">(</span><span class="n">chineseText</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="k">Then</span>
</span></span><span class="line"><span class="cl">                    <span class="n">chineseText</span> <span class="o">=</span> <span class="n">chineseText</span> <span class="o">&amp;</span> <span class="n">paraText</span>
</span></span><span class="line"><span class="cl">                <span class="k">Else</span>
</span></span><span class="line"><span class="cl">                    <span class="n">chineseText</span> <span class="o">=</span> <span class="n">paraText</span>
</span></span><span class="line"><span class="cl">                <span class="k">End</span> <span class="k">If</span>
</span></span><span class="line"><span class="cl">            <span class="k">Else</span>
</span></span><span class="line"><span class="cl">                <span class="c">&#39; 如果不是中文，则归类为英文
</span></span></span><span class="line"><span class="cl"><span class="c"></span>                <span class="c">&#39; 删除每个英文段落末尾的多余换行
</span></span></span><span class="line"><span class="cl"><span class="c"></span>                <span class="k">If</span> <span class="n">Len</span><span class="p">(</span><span class="n">englishText</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="k">Then</span>
</span></span><span class="line"><span class="cl">                    <span class="n">englishText</span> <span class="o">=</span> <span class="n">englishText</span> <span class="o">&amp;</span> <span class="n">paraText</span>
</span></span><span class="line"><span class="cl">                <span class="k">Else</span>
</span></span><span class="line"><span class="cl">                    <span class="n">englishText</span> <span class="o">=</span> <span class="n">paraText</span>
</span></span><span class="line"><span class="cl">                <span class="k">End</span> <span class="k">If</span>
</span></span><span class="line"><span class="cl">            <span class="k">End</span> <span class="k">If</span>
</span></span><span class="line"><span class="cl">        <span class="k">End</span> <span class="k">If</span>
</span></span><span class="line"><span class="cl">    <span class="k">Next</span> <span class="n">para</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 创建新的文档并输出中文和英文
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="k">Dim</span> <span class="n">newDoc</span> <span class="ow">As</span> <span class="n">Document</span>
</span></span><span class="line"><span class="cl">    <span class="k">Set</span> <span class="n">newDoc</span> <span class="o">=</span> <span class="n">Documents</span><span class="p">.</span><span class="n">Add</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 插入中文和英文部分
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="n">newDoc</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">InsertAfter</span> <span class="s">&#34;中文翻译：&#34;</span> <span class="o">&amp;</span> <span class="n">vbCrLf</span> <span class="o">&amp;</span> <span class="n">chineseText</span> <span class="o">&amp;</span> <span class="n">vbCrLf</span>
</span></span><span class="line"><span class="cl">    <span class="n">newDoc</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">InsertAfter</span> <span class="s">&#34;英文翻译：&#34;</span> <span class="o">&amp;</span> <span class="n">vbCrLf</span> <span class="o">&amp;</span> <span class="n">englishText</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 保存新文档
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="n">newDoc</span><span class="p">.</span><span class="n">SaveAs2</span> <span class="s">&#34;C:\Users\12509\Desktop\n1.docx&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">newDoc</span><span class="p">.</span><span class="n">Close</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">MsgBox</span> <span class="s">&#34;文本已清理并分离中文和英文翻译！&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">End</span> <span class="k">Sub</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&#39; 判断文本中是否包含中文字符
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="k">Function</span> <span class="nf">ContainsChinese</span><span class="p">(</span><span class="n">text</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
</span></span><span class="line"><span class="cl">    <span class="k">Dim</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
</span></span><span class="line"><span class="cl">    <span class="n">ContainsChinese</span> <span class="o">=</span> <span class="k">False</span>
</span></span><span class="line"><span class="cl">    <span class="c">&#39; 遍历文本中的每个字符
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span> <span class="k">To</span> <span class="n">Len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c">&#39; 如果字符的Unicode值在中文范围内，返回True
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="k">If</span> <span class="p">(</span><span class="n">AscW</span><span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">1</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">19968</span> <span class="ow">And</span> <span class="n">AscW</span><span class="p">(</span><span class="n">Mid</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">1</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">40959</span><span class="p">)</span> <span class="k">Then</span>
</span></span><span class="line"><span class="cl">            <span class="n">ContainsChinese</span> <span class="o">=</span> <span class="k">True</span>
</span></span><span class="line"><span class="cl">            <span class="k">Exit</span> <span class="k">Function</span>
</span></span><span class="line"><span class="cl">        <span class="nf">End</span> <span class="k">If</span>
</span></span><span class="line"><span class="cl">    <span class="k">Next</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl"><span class="k">End</span> <span class="k">Function</span>
</span></span></code></pre></div><blockquote>
<p><strong>提示</strong>：请将保存路径 <code>C:\Users\YourUsername\Desktop\...</code> 替换为你自己的桌面路径。</p></blockquote>
<hr>
<h2 id="6-效果展示">6. 效果展示</h2>
<table>
  <thead>
      <tr>
          <th>原始内容（交替段落）</th>
          <th>处理后输出</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>段落1（中文）<!-- raw HTML omitted -->段落2（英文）<!-- raw HTML omitted -->段落3（中文）<!-- raw HTML omitted -->段落4（英文）</td>
          <td>中文翻译：<!-- raw HTML omitted -->段落1<!-- raw HTML omitted -->段落3<!-- raw HTML omitted --><!-- raw HTML omitted -->英文翻译：<!-- raw HTML omitted -->段落2<!-- raw HTML omitted -->段落4</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="7-下载和使用方式">7. 下载和使用方式</h2>
<ol>
<li>打开 Word，按下 <code>Alt + F11</code> 打开 <strong>VBA 编辑器</strong></li>
<li>插入模块（Insert &gt; Module）</li>
<li>粘贴代码并保存</li>
<li>回到 Word，运行宏 <code>CleanUpAndSeparateText</code></li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>从零搭建个人博客：Hugo &#43; GitHub Pages 全流程指南</title>
      <link>http://localhost:1313/posts/guide-hugo-github-pages/</link>
      <pubDate>Fri, 07 Mar 2025 15:42:12 +0800</pubDate>
      
      <guid>http://localhost:1313/posts/guide-hugo-github-pages/</guid>
      <description>从零搭建个人博客，全面讲解 Hugo 和 GitHub Pages 的部署全过程。</description>
      <content:encoded><![CDATA[<h2 id="1-安装-hugo静态网站生成器">1. 安装 Hugo（静态网站生成器）</h2>
<p>Windows/macOS/Linux 安装 Hugo：</p>
<p>👉 打开 Hugo 官方下载页：https://gohugo.io/getting-started/installing/</p>
<p>后续步骤以 Windows 为例：</p>
<ol>
<li>下载对应版本的 .zip 解压 → 添加环境变量：</li>
</ol>
<ul>
<li>按 <code>Win + S</code>，搜索 <code>环境变量</code></li>
<li>找到「系统变量」里的 <code>Path</code>，点击「编辑」</li>
<li>点击右侧「新建」，添加 Hugo 的路径（<strong>注意</strong>：添加的是目录，不是 hugo.exe 本身！）</li>
</ul>
<ol start="2">
<li>打开命令提示符（CMD）或 PowerShell，输入命令：<code>hugo version</code>，如果看到类似输出：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">hugo</span> <span class="n">v0</span><span class="mf">.125.4</span><span class="o">-</span><span class="n">xxx</span><span class="o">-</span><span class="n">xxx</span> <span class="n">Windows</span><span class="o">/</span><span class="n">amd64</span> <span class="n">BuildDate</span><span class="o">=...</span>
</span></span></code></pre></div><p>说明 Hugo 已成功加入 PATH。</p>
<h2 id="2-配置-git-ssh-推送">2. 配置 Git SSH 推送</h2>
<p>配置到 GitHub 的 <strong>SSH 协议</strong>，避免 HTTPS 的登录验证问题，并且更稳定。</p>
<h3 id="21-生成-ssh-密钥">2.1 生成 SSH 密钥</h3>
<p>打开 PowerShell 或 Git Bash：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh-keygen -t rsa -b <span class="m">4096</span> -C <span class="s2">&#34;your_email@example.com&#34;</span>
</span></span></code></pre></div><p>按回车，一路默认。</p>
<p>会在 <code>C:\Users\你的用户名\.ssh</code> 目录下生成两份文件：</p>
<ul>
<li><code>id_rsa</code>（私钥，别泄露）</li>
<li><code>id_rsa.pub</code>（公钥）</li>
</ul>
<h3 id="22-添加-ssh-公钥到-github">2.2 添加 SSH 公钥到 GitHub</h3>
<ol>
<li>打开 GitHub：
👉 <a href="https://github.com/settings/keys">https://github.com/settings/keys</a></li>
<li>点击 &ldquo;New SSH Key&rdquo;</li>
<li>Title 可以随意填，比如：<code>my-laptop</code></li>
<li>将 <code>id_rsa.pub</code> 文件内容粘贴进去（可以用记事本打开复制）</li>
<li>点 Save</li>
</ol>
<h3 id="23-更换远程地址为-ssh">2.3 更换远程地址为 SSH</h3>
<p>在 <code>public/</code> 目录中运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">git</span> <span class="n">remote</span> <span class="nb">set</span><span class="o">-</span><span class="n">url</span> <span class="n">origin</span> <span class="n">git</span><span class="nd">@github.com</span><span class="p">:</span><span class="n">YOUR</span><span class="o">/</span><span class="n">PATH</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">git</span>
</span></span></code></pre></div><h2 id="3-本地新建-hugo-项目">3. 本地新建 Hugo 项目</h2>
<p>打开终端（CMD / PowerShell），执行下面的命令：</p>
<h3 id="31-任选磁盘位置建根目录">3.1 任选磁盘位置建根目录</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">mkdir</span> <span class="n">D:</span><span class="p">\</span><span class="nb">hugo-myblog</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd </span><span class="n">D:</span><span class="p">\</span><span class="nb">hugo-myblog</span>
</span></span></code></pre></div><h3 id="32-创建站点">3.2 创建站点</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">hugo</span> <span class="n">new</span> <span class="n">site</span> <span class="n">myblog</span>
</span></span></code></pre></div><p>会看到提示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">Congratulations</span><span class="o">!</span> <span class="n">Your</span> <span class="k">new</span> <span class="n">Hugo</span> <span class="n">site</span> <span class="n">was</span> <span class="n">created</span><span class="p">...</span>
</span></span></code></pre></div><h3 id="33-初始化-git">3.3 初始化 Git</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">cd </span><span class="n">myblog</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">init</span>
</span></span></code></pre></div><h3 id="34-添加主题推荐-papermodx">3.4 添加主题（推荐 PaperModX）</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">git</span> <span class="n">submodule</span> <span class="n">add</span> <span class="n">git</span><span class="nv">@github</span><span class="p">.</span><span class="n">com</span><span class="err">:</span><span class="n">adityatelange</span><span class="p">/</span><span class="nb">hugo-PaperMod</span><span class="p">.</span><span class="py">git</span> <span class="n">themes</span><span class="p">/</span><span class="n">PaperMod</span>
</span></span></code></pre></div><h3 id="35-配置-configtoml">3.5 配置 <code>config.toml</code></h3>
<p>打开终端（CMD / PowerShell），执行下面的命令：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">notepad</span> <span class="n">config</span><span class="p">.</span><span class="py">toml</span>
</span></span></code></pre></div><p>会提示你新建文件，在打开的窗口输入下面的内容：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="nx">baseURL</span> <span class="p">=</span> <span class="s2">&#34;http://localhost:1313/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">languageCode</span> <span class="p">=</span> <span class="s2">&#34;zh-CN&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;Your Blog&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">theme</span> <span class="p">=</span> <span class="s2">&#34;PaperMod&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableRobotsTXT</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">pagination</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">pagerSize</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">author</span> <span class="p">=</span> <span class="s2">&#34;Your name&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">showReadingTime</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowShareButtons</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowBreadCrumbs</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowCodeCopyButtons</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ShowToc</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">TocOpen</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="nx">defaultTheme</span> <span class="p">=</span> <span class="s2">&#34;auto&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">menu</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;主页&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;归档&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/archives&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;标签&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/tags&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">weight</span> <span class="p">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">markup</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">highlight</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">noClasses</span> <span class="p">=</span> <span class="kc">false</span>
</span></span></code></pre></div><p><strong>注意</strong>：如果出现问题，用记事本打开检查，重新保存为「UTF-8 无 BOM」编码格式。</p>
<h3 id="36-写一篇测试文章">3.6 写一篇测试文章</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">hugo</span> <span class="n">new</span> <span class="n">posts</span><span class="p">/</span><span class="nb">hello-world</span><span class="p">.</span><span class="nb">md
</span></span></span><span class="line"><span class="cl"><span class="nb"></span><span class="n">notepad</span> <span class="n">content</span><span class="p">/</span><span class="n">posts</span><span class="p">/</span><span class="n">hello</span><span class="p">.</span><span class="nb">md
</span></span></span></code></pre></div><p>编辑 <code>content/posts/hello-world.md</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-md" data-lang="md"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">title: &#34;你好，博客世界！&#34;
</span></span><span class="line"><span class="cl">date: 2025-06-06
</span></span><span class="line"><span class="cl">tags: [&#34;本地上传&#34;, &#34;测试&#34;]
</span></span><span class="line"><span class="cl">draft: false
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">这是我的第一篇博客文章！欢迎来到我的 Hugo 博客。
</span></span></code></pre></div><p>保存并关闭。</p>
<h3 id="37-本地预览博客效果">3.7 本地预览博客效果</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">hugo</span> <span class="n">server</span> <span class="n">-D</span>
</span></span></code></pre></div><p>浏览器访问 http://localhost:1313/，确保页面能正常显示并加载样式（有标题、菜单、文章列表）。</p>
<h2 id="4-github-仓库配置">4 GitHub 仓库配置</h2>
<h3 id="41-创建双仓库">4.1 创建双仓库</h3>
<table>
  <thead>
      <tr>
          <th>仓库名</th>
          <th>用途</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>myblog</strong></td>
          <td>源码仓库（存放  <code>config.toml</code>、Markdown、主题等）</td>
      </tr>
      <tr>
          <td><strong>.github.io</strong></td>
          <td>发布仓库（存放 Hugo 构建后的静态页面）</td>
      </tr>
  </tbody>
</table>
<p><strong>注意：</strong></p>
<ol>
<li>第二个仓库名必须是：<code>你的用户名.github.io</code></li>
<li><strong>不需要初始化 README</strong>（保持空仓库）</li>
</ol>
<h3 id="42-创建一个-github-个人访问令牌pat">4.2 创建一个 GitHub 个人访问令牌（PAT）</h3>
<p>GitHub 的自动生成 <code>GITHUB_TOKEN</code> <strong>不允许跨仓库 push</strong>，所以需要 <strong>PAT（GitHub Personal Access Token）</strong>。</p>
<ol>
<li>打开链接：https://github.com/settings/tokens?type=beta</li>
<li>点击 <code>Generate new token</code> → 选择 <strong>Fine-grained token</strong></li>
<li>填写信息：
<ul>
<li><strong>Name</strong>：hugo-pages-token</li>
<li><strong>Expiration</strong>：90 days（或自定义）</li>
<li><strong>Repository access</strong>：只选择 <code>.github.io</code>仓库</li>
<li><strong>权限设置</strong>：
<ul>
<li><code>Contents</code> → 勾选 <strong>Read and Write</strong></li>
</ul>
</li>
</ul>
</li>
<li>最后点击 <strong>Generate token</strong></li>
<li>拷贝生成的 token（只会显示一次！）</li>
</ol>
<h3 id="43-添加-token-到-myblog-仓库的-secrets-中">4.3 添加 token 到 <code>myblog</code> 仓库的 Secrets 中</h3>
<ol>
<li>打开 <code>myblog</code> 仓库</li>
<li>点顶部导航栏 → <code>Settings</code></li>
<li>左边栏选择 <code>Secrets and variables &gt; Actions</code></li>
<li>点击 <code>New repository secret</code>
<ul>
<li>Name: <code>PERSONAL_TOKEN</code></li>
<li>Secret: 粘贴你刚生成的 token</li>
</ul>
</li>
</ol>
<h2 id="5-github-pages-部署">5. GitHub Pages 部署</h2>
<h3 id="51-连接远程并首次推送源码">5.1 连接远程并首次推送源码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">origin</span> <span class="n">git</span><span class="nv">@github</span><span class="p">.</span><span class="n">com</span><span class="err">:</span><span class="p">&lt;</span><span class="n">USERNAME</span><span class="p">&gt;/</span><span class="n">myblog</span><span class="p">.</span><span class="py">git</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">add</span> <span class="p">.</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">commit</span> <span class="n">-m</span> <span class="s2">&#34;🎉 初始化 Hugo 博客&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">push</span> <span class="n">-u</span> <span class="n">origin</span> <span class="n">master</span>
</span></span></code></pre></div><h3 id="52-设置-github-actions-自动部署">5.2 设置 GitHub Actions 自动部署</h3>
<p>创建部署脚本文件</p>
<pre tabindex="0"><code>mkdir .github\workflows
notepad .github\workflows\deploy.yml
</code></pre><p>在打开的记事本中，复制并粘贴以下内容：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy Hugo site to GitHub Pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">master]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">permissions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l">write           </span><span class="w"> </span><span class="c"># 允许推送另一个仓库</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Checkout source</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">submodules</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup Hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-hugo@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">hugo-version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;0.147.0&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build site</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">hugo --minify --baseURL &#34;https://&lt;USERNAME&gt;.github.io/&#34;  </span><span class="w"> </span><span class="c"># 换成你的线上域名</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy to GitHub Pages</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-gh-pages@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">personal_token</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.PERSONAL_TOKEN }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">external_repository</span><span class="p">:</span><span class="w"> </span><span class="l">&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">publish_dir</span><span class="p">:</span><span class="w"> </span><span class="l">./public</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">publish_branch</span><span class="p">:</span><span class="w"> </span><span class="l">master</span><span class="w">
</span></span></span></code></pre></div><p>保存后推送：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">git</span> <span class="n">add</span> <span class="p">.</span><span class="n">github</span><span class="p">/</span><span class="n">workflows</span><span class="p">/</span><span class="n">deploy</span><span class="p">.</span><span class="py">yml</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">commit</span> <span class="n">-m</span> <span class="s2">&#34;添加 GitHub Actions 自动部署脚本&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">push</span>
</span></span></code></pre></div><h3 id="53-启用github-pages-配置">5.3 启用GitHub Pages 配置</h3>
<ol>
<li>进入你的仓库 <code>myblog</code></li>
<li>点击 <code>Settings</code></li>
<li>左侧点击 <strong>Pages</strong></li>
<li>查看是否显示如下内容：</li>
</ol>
<pre tabindex="0"><code>Your site is live at https://YOURNAME.github.io/
</code></pre><p>如果没有，确保以下设置正确：</p>
<ul>
<li><strong>Source</strong>: Deploy from a branch ✅</li>
<li><strong>Branch</strong>: 选择 <code>master</code> ✅</li>
<li><strong>/ (root)</strong>: 保持默认 ✅</li>
<li>点一次 <code>Save</code></li>
</ul>
<h3 id="54-等待-actions-完成">5.4 等待 Actions 完成</h3>
<p>推送成功后，进入 GitHub：</p>
<ol>
<li>打开 <code>myblog</code> 仓库 → 右上角 &ldquo;Actions&rdquo; 出现 <strong>Deploy Hugo site to GitHub Pages</strong> 任务</li>
<li>全绿 ✅ 表示构建 + 推送成功</li>
<li>打开 <code>https://github.com/&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io</code> 应看到 <code>index.html</code> 等文件</li>
</ol>
<h3 id="55-打开-github-pages">5.5 打开 GitHub Pages</h3>
<p><code>https://&lt;USERNAME&gt;.github.io/</code> 刷新几次，样式完整即上线成功！</p>
<h2 id="6-日常写作工作流">6 日常写作工作流</h2>
<p>当你想要上线新的笔记或文章时，按照下面操作即可：</p>
<ol>
<li><strong>创建新文章</strong>：在你的 Hugo 项目中，使用 <code>hugo new</code> 命令创建新的 Markdown 文件。例如：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">hugo new posts/my-note.md
</span></span></code></pre></div><ol start="2">
<li><strong>编辑文章内容</strong>：打开新创建的 Markdown 文件（例如 <code>content/posts/my-note.md</code>），使用 Markdown 语法编写你的内容。确保在文件的开头设置正确的元数据，如标题、日期、标签等。并确保设置 <code>draft: false</code> 才会被 Hugo 编译到页面中。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">title: &#34;我的新笔记&#34;
</span></span><span class="line"><span class="cl">date: 2025-06-08T10:00:00+08:00
</span></span><span class="line"><span class="cl">tags: [&#34;笔记&#34;]
</span></span><span class="line"><span class="cl">draft: false
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">笔记内容。
</span></span></code></pre></div><ol start="3">
<li><strong>本地预览</strong>：启动 Hugo 本地服务后打开浏览器访问：<code>http://localhost:1313/</code> 即可实时预览。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">hugo</span> <span class="n">server</span> <span class="n">-D</span>
</span></span></code></pre></div><ol start="4">
<li><strong>提交到 Git 仓库</strong>：将修改提交到 Git 仓库并推送到远程仓库。</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git add content/posts/my-note.md
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;添加新笔记：XXX&#34;</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span></code></pre></div><ol start="5">
<li><strong>等待 Actions 自动部署</strong>：</li>
</ol>
<ul>
<li>GitHub Actions 将会自动检测到你的推送并触发自动部署流程。你的新笔记将被构建并发布到 GitHub Pages 上。</li>
</ul>
<ol start="6">
<li><strong>访问网站</strong>：</li>
</ol>
<ul>
<li>打开你的 GitHub Pages 网站地址（例如 <code>https://&lt;USERNAME&gt;.github.io/</code>），查看新笔记是否已经成功发布。</li>
</ul>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
